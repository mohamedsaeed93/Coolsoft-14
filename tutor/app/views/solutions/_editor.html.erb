<!-- Add editor -->
-<%= form_for :solution,
       :url => { :controller => "solutions", :action => "create" },
       :html => {:method => :post} do |f| %>

<!-- Class name field -->
<h4>File name:</h4>
<textarea value: "CoolSoft", class: "form-control",
	style: "width: 250px; height: 44px;", id: "class_name"></textarea>

<% f.hidden_field "type", value: params[:controller] %>
<% @type = "" %>
<% @controller = params[:controller] %>
<% if @controller == "problems" %>
	<% @type = "Problem" %>
<% elsif @controller == "cproblem" %>
	<% @type = "Cproblem" %>
<% else %>
	<% @type = "AssignmentProblem" %>
<% end %>
<%end%>


<table width='100%'>
	<tr>
		<td>
			<%= button_tag 'Reload Template', type: 'Button', id: 'reloadButton',
				onClick: "reload_template()", class: "btn btn-info" %>
			<%= button_tag 'Compile', type: 'Button',id: 'compileButton', 
				onClick: "compile(#{params[:id]}, '#{@type}')", class: "btn btn-info" %>
			<%= button_tag 'Run Test Case', class: "btn btn-info", id: 'testButton', 
				type: 'Button', onClick: "run_input(#{params[:id]}, '#{@type}')" %>
			<%= button_tag 'Start Debugging', id: 'debugButton', type: 'button',
				onclick: "start_debug(#{params[:id]}, '#{@type}')", class: "btn btn-info" %>	
			<%= button_tag 'Previous', type: 'Button', class: "btn btn-info", 
				style: "display: none", id: 'previousButton', 
				onClick: 'previous()', hidden: true %>
			<%= button_tag 'Next', type: 'Button', class: "btn btn-info",
				style: "display: none", id: 'nextButton',
				onClick: 'next()', hidden: true %>
			<%= button_tag 'Stop Debugging', type: 'Button', class: "btn btn-info",
				style: "display: none", id: 'stopButton', 
				onClick: 'stop()', hidden: true %>
			<select id='theme' onchange="changeTheme()" class="selectpicker" data-style="btn-info" data-width="auto">
				<option value="twilight">twilight</option>
				<option value="eclipse">eclipse</option>
				<option value="xcode">xcode</option>
				<option value="chaos">chaos</option>
				<option value="chrome">chrome</option>
				<option value="clouds">clouds</option>
				<option value="tomorrow_night_blue">night blue</option>
				<option value="tomorrow_night_eighties">tomorrow night eighties</option>
				<option value="github">github</option>
				<option value="dreamweaver">dreamweaver</option>
			</select> 
			<select id='mode' onchange="changeMode()" class="selectpicker" data-style="btn-info" data-width="auto">
				<option value="java">Java</option>
				<option value="python">Python</option>
			</select>
			<select id='font' onchange="changeFont()" class="selectpicker" data-style="btn-info" data-width="auto">
				<option value="12">12</option>
				<option value="14">14</option>
				<option value="16">16</option>
				<option value="18">18</option>
				<option value="20">20</option>
				<option value="22">22</option>
				<option value="24">24</option>
			</select>
			<span id="spinner" class="" align="center"></span>
		</td>
	</tr>
</table>


<div id="editor" style="white-space: pre">
public class CoolSoft {
	public static void main(String [] args) {
&#09;&#09;
	}
}
</div>

<%= button_tag 'Submit', type: 'Button',id: 'submitButton', 
				onClick: "validate_code(#{params[:id]}, '#{@type}')", class: "btn btn-info pull-right" %>

<br>

<script>
	var editor = ace.edit("editor");
	var edit_session = editor.getSession();
	var hidden_code_field = document.getElementById('solution_code')
	var code_header = "public class CoolSoft {\n";
	var code_footer = "\n}";

	editor.setTheme("ace/theme/twilight");
	edit_session.setMode("ace/mode/java");

	edit_session.setValue(code_header + hidden_code_field.value);

	var code_filter_function = function(event_handler) {
		var unfiltered_code = edit_session.getValue();
		var code_len = unfiltered_code.length;
		var line_count = edit_session.doc.getAllLines().length;
		hidden_code_field.value = unfiltered_code.slice(code_header.length)
	};
	edit_session.on('change', code_filter_function);
</script>